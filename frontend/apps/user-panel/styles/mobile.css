/* ===================== Mobile Responsive Styles ===================== */

/* Mobile-first approach with responsive breakpoints */
/* xs: < 576px, sm: 576px+, md: 768px+, lg: 992px+, xl: 1200px+ */

/* CRITICAL: Override any external library styles that could cause sidebar overflow */
.main-sidebar,
.mobile-sidebar,
aside.main-sidebar,
aside.mobile-sidebar,
aside.main-sidebar.sidebar-light-indigo,
aside.main-sidebar.elevation-4,
aside.main-sidebar.mobile-sidebar {
  max-width: calc(100vw - 20px) !important;
  width: auto !important;
  box-sizing: border-box !important;
  overflow-x: hidden !important;
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: auto !important;
  z-index: 1031 !important;
}

/* Force dynamic width calculation to take precedence over any external CSS */
.main-sidebar[style*="width"],
.mobile-sidebar[style*="width"],
aside.main-sidebar[style*="width"],
aside.mobile-sidebar[style*="width"] {
  width: var(--sidebar-width, auto) !important;
  max-width: calc(100vw - 20px) !important;
}

/* ===================== Base Mobile Styles ===================== */
@media (max-width: 767.98px) {
  /* Hide desktop-only elements on mobile */
  .d-md-inline {
    display: none !important;
  }
  
  .d-md-block {
    display: none !important;
  }
  
  .d-md-flex {
    display: none !important;
  }
  
  /* Show mobile-only elements */
  .d-mobile-inline {
    display: inline !important;
  }
  
  .d-mobile-block {
    display: block !important;
  }
  
  .d-mobile-flex {
    display: flex !important;
  }

  /* ===================== Layout Adjustments ===================== */
  .content-wrapper {
    margin-left: 0 !important;
    width: 100% !important;
    padding: 8px !important;
  }

  /* ===================== Navigation Bar ===================== */
  .main-header.navbar {
    padding-left: 8px !important;
    padding-right: 8px !important;
  }

  .navbar-nav .nav-link {
    padding: 8px 12px !important;
    font-size: 14px !important;
  }

  /* ===================== Sidebar Mobile Overlay ===================== */
  .main-sidebar {
    width: 280px !important;
    max-width: 85vw !important;
    min-width: 250px !important;
  }

  /* Critical: Ensure sidebar never exceeds viewport width */
  .main-sidebar,
  .mobile-sidebar {
    max-width: calc(100vw - 20px) !important;
    box-sizing: border-box !important;
    overflow-x: hidden !important;
  }

  /* Override any fixed positioning that could cause overflow */
  .main-sidebar,
  .mobile-sidebar {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: auto !important;
    width: auto !important;
    max-width: calc(100vw - 20px) !important;
    min-width: 250px !important;
    height: 100vh !important;
    z-index: 1031 !important;
    transform: translateX(0) !important;
    transition: transform 0.3s ease-in-out, width 0.3s ease-in-out !important;
  }

  /* Force mobile sidebar to be properly positioned */
  @media (max-width: 767.98px) {
    .main-sidebar {
      position: fixed !important;
      top: 0 !important;
      left: -280px !important; /* Hidden by default */
      width: 280px !important;
      max-width: 85vw !important;
      height: 100vh !important;
      z-index: 1031 !important;
      background: #03045E !important;
      box-shadow: 2px 0 8px rgba(0,0,0,0.15) !important;
      display: flex !important;
      flex-direction: column !important;
      overflow: hidden !important;
      transform: translateX(-100%) !important;
      transition: transform 0.3s ease-in-out !important;
      box-sizing: border-box !important;
    }

    /* Mobile sidebar when open */
    .mobile-sidebar {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      width: 280px !important;
      max-width: calc(100vw - 20px) !important;
      height: 100vh !important;
      z-index: 1031 !important;
      background: #03045E !important;
      box-shadow: 2px 0 8px rgba(0,0,0,0.15) !important;
      display: flex !important;
      flex-direction: column !important;
      overflow: hidden !important;
      transform: translateX(0) !important;
      transition: transform 0.3s ease-in-out !important;
      visibility: visible !important;
      opacity: 1 !important;
      box-sizing: border-box !important;
      max-height: 100vh !important;
    }

    /* Ensure desktop sidebar is hidden on mobile */
    .main-sidebar:not(.mobile-sidebar) {
      left: -280px !important;
      transform: translateX(-100%) !important;
    }
  }

  /* Mobile sidebar container */
  .mobile-sidebar-container {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    z-index: 1031 !important;
    background: rgba(0,0,0,0.5) !important;
  }

  /* Mobile sidebar content */
  .mobile-sidebar-content {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 280px !important;
    max-width: calc(100vw - 20px) !important;
    min-width: 250px !important;
    height: 100vh !important;
    background: #03045E !important;
    box-shadow: 2px 0 8px rgba(0,0,0,0.15) !important;
    overflow: hidden !important;
    display: flex !important;
    flex-direction: column !important;
  }

  .brand-text {
    font-size: 18px !important;
    letter-spacing: 1px !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }

  /* Mobile navigation text handling */
  .nav-header {
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }

  .nav-link {
    white-space: nowrap !important;
  }

  /* Very narrow screens (< 360px) - full overlay drawer */
  @media (max-width: 360px) {
    .main-sidebar,
    .mobile-sidebar {
      width: 100vw !important;
      max-width: 100vw !important;
      min-width: unset !important;
    }
  }

  /* Narrow screens (360px - 480px) - 80% of viewport */
  @media (min-width: 361px) and (max-width: 480px) {
    .main-sidebar,
    .mobile-sidebar {
      width: 80vw !important;
      max-width: 80vw !important;
      min-width: unset !important;
    }
  }

  /* Small screens (481px - 767px) - 60% of viewport */
  @media (min-width: 481px) and (max-width: 767px) {
    .main-sidebar,
    .mobile-sidebar {
      width: 60vw !important;
      max-width: 60vw !important;
      min-width: unset !important;
    }
  }

  /* Small screens - ensure sidebar doesn't overflow */
  @media (max-width: 576px) {
    .main-sidebar,
    .mobile-sidebar {
      width: calc(100vw - 20px) !important;
      max-width: calc(100vw - 20px) !important;
      min-width: 250px !important;
    }
  }

  /* Prevent body scroll when mobile sidebar is open */
  body.mobile-sidebar-open {
    overflow: hidden !important;
    position: fixed !important;
    width: 100% !important;
  }

  /* Ensure mobile sidebar backdrop covers entire screen */
  .mobile-sidebar-backdrop {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    z-index: 1030 !important;
    background-color: rgba(0, 0, 0, 0.5) !important;
    backdrop-filter: blur(2px) !important;
  }

  .nav-link span {
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }

  /* Ensure sidebar content is properly contained */
  .mobile-sidebar .sidebar {
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
    max-height: calc(100vh - 60px) !important; /* Account for header height */
    box-sizing: border-box !important;
  }

  /* Ensure desktop sidebar content is properly contained */
  .main-sidebar .sidebar {
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
    max-height: calc(100vh - 60px) !important; /* Account for header height */
    box-sizing: border-box !important;
  }

  /* Better text handling for very small screens */
  @media (max-width: 360px) {
    .mobile-sidebar .brand-text {
      font-size: 14px !important;
      letter-spacing: 0.5px !important;
    }
    
    .mobile-sidebar .nav-header {
      font-size: 11px !important;
      padding: 10px 12px !important;
    }
    
    .mobile-sidebar .nav-link {
      font-size: 11px !important;
      padding: 6px 12px !important;
    }
  }

  .nav-header {
    padding: 12px 16px !important;
    font-size: 13px !important;
  }

  .nav-link {
    padding: 8px 16px !important;
    font-size: 12px !important;
  }

  /* ===================== Cards and Containers ===================== */
  .card {
    margin-bottom: 16px !important;
    border-radius: 8px !important;
  }

  .card-header {
    padding: 12px 16px !important;
    font-size: 16px !important;
  }

  .card-body {
    padding: 16px !important;
  }

  /* ===================== Tables ===================== */
  .table-responsive {
    border-radius: 8px !important;
    margin-bottom: 16px !important;
  }

  .table {
    font-size: 12px !important;
    margin-bottom: 0 !important;
  }

  .table th,
  .table td {
    padding: 8px 6px !important;
    vertical-align: middle !important;
    white-space: nowrap !important;
  }

  .table th {
    font-size: 11px !important;
    font-weight: 600 !important;
    background-color: #f8f9fa !important;
    border-bottom: 2px solid #dee2e6 !important;
  }

  /* Hide less important columns on mobile */
  .table .d-mobile-hide {
    display: none !important;
  }

  /* ===================== Buttons ===================== */
  .btn {
    padding: 8px 12px !important;
    font-size: 12px !important;
    border-radius: 6px !important;
    margin: 2px !important;
  }

  .btn-sm {
    padding: 6px 10px !important;
    font-size: 11px !important;
  }

  .btn-group .btn {
    margin: 0 !important;
  }

  /* ===================== Forms ===================== */
  .form-control {
    font-size: 14px !important;
    padding: 10px 12px !important;
    border-radius: 6px !important;
  }

  .form-group {
    margin-bottom: 16px !important;
  }

  .form-label {
    font-size: 13px !important;
    font-weight: 600 !important;
    margin-bottom: 6px !important;
  }

  /* ===================== Modals ===================== */
  .modal-dialog {
    margin: 8px !important;
    max-width: calc(100% - 16px) !important;
  }

  .modal-content {
    border-radius: 8px !important;
  }

  .modal-header {
    padding: 12px 16px !important;
  }

  .modal-body {
    padding: 16px !important;
    max-height: 70vh !important;
    overflow-y: auto !important;
  }

  .modal-footer {
    padding: 12px 16px !important;
  }

  /* ===================== Dropdowns ===================== */
  .dropdown-menu {
    font-size: 13px !important;
    border-radius: 6px !important;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
  }

  .dropdown-item {
    padding: 8px 16px !important;
    font-size: 13px !important;
  }

  /* ===================== Alerts and Notifications ===================== */
  .alert {
    padding: 12px 16px !important;
    font-size: 13px !important;
    border-radius: 6px !important;
    margin-bottom: 16px !important;
  }

  /* ===================== Pagination ===================== */
  .pagination {
    justify-content: center !important;
    margin: 16px 0 !important;
  }

  .page-link {
    padding: 6px 10px !important;
    font-size: 12px !important;
    margin: 0 2px !important;
  }

  /* ===================== Badges and Labels ===================== */
  .badge {
    font-size: 10px !important;
    padding: 4px 6px !important;
  }

  /* ===================== Small Boxes (Dashboard Cards) ===================== */
  .small-box {
    margin-bottom: 16px !important;
    border-radius: 8px !important;
  }

  .small-box .inner {
    padding: 16px !important;
  }

  .small-box .inner h3 {
    font-size: 24px !important;
    margin-bottom: 8px !important;
  }

  .small-box .inner p {
    font-size: 13px !important;
    margin-bottom: 0 !important;
  }

  .small-box .icon {
    font-size: 40px !important;
  }

  /* ===================== DataTables Mobile Optimization ===================== */
  .dataTables_wrapper {
    font-size: 12px !important;
  }

  .dataTables_length,
  .dataTables_filter {
    margin-bottom: 12px !important;
  }

  .dataTables_length select,
  .dataTables_filter input {
    font-size: 12px !important;
    padding: 4px 8px !important;
    height: auto !important;
  }

  .dataTables_info {
    font-size: 11px !important;
    margin-top: 8px !important;
  }

  .dataTables_paginate {
    margin-top: 8px !important;
  }

  .dataTables_paginate .paginate_button {
    padding: 4px 8px !important;
    font-size: 11px !important;
    margin: 0 2px !important;
  }

  /* ===================== Custom Mobile Utilities ===================== */
  .mobile-text-center {
    text-align: center !important;
  }

  .mobile-text-left {
    text-align: left !important;
  }

  .mobile-text-right {
    text-align: right !important;
  }

  .mobile-mb-2 {
    margin-bottom: 8px !important;
  }

  .mobile-mb-3 {
    margin-bottom: 16px !important;
  }

  .mobile-mt-2 {
    margin-top: 8px !important;
  }

  .mobile-mt-3 {
    margin-top: 16px !important;
  }

  .mobile-p-2 {
    padding: 8px !important;
  }

  .mobile-p-3 {
    padding: 16px !important;
  }

  /* ===================== Touch-Friendly Elements ===================== */
  .btn,
  .nav-link,
  .dropdown-toggle,
  .page-link {
    min-height: 44px !important;
    min-width: 44px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }

  /* ===================== Horizontal Scrolling for Tables ===================== */
  .table-responsive {
    -webkit-overflow-scrolling: touch !important;
    overflow-x: auto !important;
  }

  /* ===================== Mobile-Specific Grid Adjustments ===================== */
  .row {
    margin-left: -8px !important;
    margin-right: -8px !important;
  }

  .col-12,
  .col-6,
  .col-4,
  .col-3 {
    padding-left: 8px !important;
    padding-right: 8px !important;
  }

  /* ===================== Mobile Navigation Improvements ===================== */
  .navbar-toggler {
    border: none !important;
    padding: 8px !important;
  }

  .navbar-toggler:focus {
    box-shadow: none !important;
  }

  /* ===================== Mobile Profile Dropdown ===================== */
  .user-menu .dropdown-menu {
    right: 8px !important;
    left: auto !important;
    min-width: 280px !important;
  }

  /* ===================== Mobile Footer ===================== */
  .main-footer {
    text-align: center !important;
    padding: 16px 8px !important;
    font-size: 12px !important;
  }

  .main-footer .float-right {
    float: none !important;
    display: block !important;
    margin-top: 8px !important;
  }
}

/* ===================== Tablet Styles ===================== */
@media (min-width: 768px) and (max-width: 991.98px) {
  .content-wrapper {
    margin-left: 0 !important;
    width: 100% !important;
    padding: 12px !important;
  }

  .table th,
  .table td {
    padding: 10px 8px !important;
    font-size: 13px !important;
  }

  .btn {
    padding: 10px 14px !important;
    font-size: 13px !important;
  }

  .card-body {
    padding: 20px !important;
  }
}

/* ===================== Large Mobile Styles (Landscape) ===================== */
@media (max-width: 767.98px) and (orientation: landscape) {
  .content-wrapper {
    padding: 4px !important;
  }

  .card-body {
    padding: 12px !important;
  }

  .table th,
  .table td {
    padding: 6px 4px !important;
    font-size: 11px !important;
  }

  .btn {
    padding: 6px 10px !important;
    font-size: 11px !important;
  }
}

/* ===================== Print Styles ===================== */
@media print {
  .main-sidebar,
  .main-header,
  .main-footer,
  .btn,
  .pagination {
    display: none !important;
  }

  .content-wrapper {
    margin-left: 0 !important;
    width: 100% !important;
  }

  .table {
    font-size: 10px !important;
  }

  .table th,
  .table td {
    padding: 4px !important;
  }
}
